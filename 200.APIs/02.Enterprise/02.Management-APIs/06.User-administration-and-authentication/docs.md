---
title: User administration and authentication
taxonomy:
    category: docs
api: true
template: docs
---

<a name="overview"></a>
## Overview
An API for user administration and user authentication handling. Intended for use by the web GUI.
All responses from the API will contain 'X-MEN-RequestID' header with server-side generated request ID.


### Version information
*Version* : 1


### URI scheme
*Host* : hosted.mender.io  
*BasePath* : /api/management/v1/useradm  
*Schemes* : HTTPS




<a name="paths"></a>
## Paths
- [POST/auth/login](#auth-login-post)
- [POST/roles](#roles-post)
- [GET/roles](#roles-get)
- [GET/roles/{id}](#roles-id-get)
- [PUT/roles/{id}](#roles-id-put)
- [DELETE/roles/{id}](#roles-id-delete)
- [POST/settings](#settings-post)
- [GET/settings](#settings-get)
- [POST/users](#users-post)
- [GET/users](#users-get)
- [GET/users/{id}](#users-id-get)
- [PUT/users/{id}](#users-id-put)
- [DELETE/users/{id}](#users-id-delete)


___
<a name="auth-login-post"></a>
### Log in to Mender
```
POST /auth/login
```


#### Description
Accepts user credentials via standard Basic Auth, and returns a
JWT token to be used for authentication in subsequent requests.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Standard Basic Auth header, based on user's credentials.|string|
|**Body**|**token2fa**  <br>*optional*|Two factor authentication token, required if two factor authentication is<br>enabled and tenant's plan is Professional or Enterprise.|[Twofactor](#twofactor)|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**200**|Authentication successful - a new JWT is issued and returned.<br>The JWT is signed with the API's private key ('RS256' signing algorithm),<br>and contains the following standard claims:<br>* 'iss' - issuer<br>* 'exp' - expiry date<br>* 'sub' - unique, autogenerated user ID<br>* 'scp' - 'mender.*', allows access to all APIs/methods|No Content|
|**400**|Bad request, see error message for details.|[Error](#error)|
|**401**|The user is not authorized. There are two possible scenarios for that:<br>* username/password do not match<br>* token for two factor authentication (if enabled) was not correct|[Error](#error)|
|**403**|Feature not available in your Plan.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP request

##### Request body
```json
{
  "token2fa" : "012234"
}
```


#### Example HTTP response

##### Response 200
```json
{
  "application/jwt" : "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9. eyJleHAiOjE0NzYxMTkxMzYsImlzcyI6Ik1lbmRlciIsIn N1YiI6Ijg1NGIzMTA5LTQ4NjItNGEyNS1hMWZiLWYxMTE2 MWNlN2E4NCIsInNjcCI6WyJtZW5kZXIuKiJdfQ. X7Ief4PhPLlR6mA2wh3G3K0Z2tud0rK1QJesxu52NfICSe ARmlujczs-_1YZxMwI0s-HgpXHbXIjaSVK80BjxjAM1rqp RGvgqSqG-dU5KmglDpAaTr4VaJci3VFPlVUVTRpI7bfqNM nKZtjmOUAGwjvroDUwX1RwayEmms-efGI"
}
```


##### Response 400
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 403
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="roles-post"></a>
### Create role
```
POST /roles
```


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|
|**Body**|**role**  <br>*required*|New role data.|[Role](#role)|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**201**|The role was successfully created.  <br>**Headers** :   <br>`Location` (string) : URI for the newly created 'Role' resource.|No Content|
|**400**|The request body is malformed.|[Error](#error)|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP request

##### Request body
```json
{
  "name" : "RBAC_ROLE_NAME",
  "description" : "Description of the role",
  "permissions" : [ {
    "action" : "http",
    "object" : [ {
      "type" : "GET"
    }, {
      "value" : "/api/v1/endpoint"
    } ]
  }, {
    "action" : "http",
    "object" : [ {
      "type" : "POST"
    }, {
      "value" : "/api/v1/endpoint"
    } ]
  } ]
}
```


#### Example HTTP response

##### Response 400
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="roles-get"></a>
### List roles
```
GET /roles
```


#### Description
Returns a non-paged collection of roles information.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**200**|Successful response.|< [Role](#role) > array|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP response

##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="roles-id-get"></a>
### Get role information
```
GET /roles/{id}
```


#### Description
Returns role information.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|
|**Path**|**id**  <br>*required*|Role id.|string|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**200**|Successful response - a role information is returned.|[Role](#role)|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**404**|The role was not found.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP response

##### Response 200
```json
{
  "name" : "RBAC_ROLE_NAME",
  "description" : "Description of the role",
  "permissions" : [ {
    "action" : "http",
    "object" : [ {
      "type" : "GET"
    }, {
      "value" : "/api/v1/endpoint"
    } ]
  }, {
    "action" : "http",
    "object" : [ {
      "type" : "POST"
    }, {
      "value" : "/api/v1/endpoint"
    } ]
  } ]
}
```


##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 404
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="roles-id-put"></a>
### Update role information
```
PUT /roles/{id}
```


#### Description
Update role description and list of permissions.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|
|**Path**|**id**  <br>*required*|Role id.|string|
|**Body**|**role_update**  <br>*required*|Updated role data.|[Role](#role)|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**202**|Role information updated.|No Content|
|**400**|The request body is malformed.|[Error](#error)|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**404**|The role does not exist.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP request

##### Request body
```json
{
  "name" : "RBAC_ROLE_NAME",
  "description" : "Description of the role",
  "permissions" : [ {
    "action" : "http",
    "object" : [ {
      "type" : "GET"
    }, {
      "value" : "/api/v1/endpoint"
    } ]
  }, {
    "action" : "http",
    "object" : [ {
      "type" : "POST"
    }, {
      "value" : "/api/v1/endpoint"
    } ]
  } ]
}
```


#### Example HTTP response

##### Response 400
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 404
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="roles-id-delete"></a>
### Remove role from the system
```
DELETE /roles/{id}
```


#### Description
Remove role information from the system.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|
|**Path**|**id**  <br>*required*|Role id.|string|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**204**|Role removed.|No Content|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP response

##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="settings-post"></a>
### Set user settings
```
POST /settings
```


#### Description
Create user settings or replace existing settings with provided object. This endpoint can be used to enable or disable two factor authentication by sending '{"2fa":"enabled"}' or '{"2fa":"disabled"}', respectively.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|
|**Body**|**settings**  <br>*required*|New user settings.|[Settings](#settings)|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**201**|User settings set.|No Content|
|**400**|The request body is malformed.|[Error](#error)|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP response

##### Response 400
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="settings-get"></a>
### Get user settings
```
GET /settings
```


#### Description
Returns user settings.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**200**|Successful response - a user information is returned.|[Settings](#settings)|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP response

##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="users-post"></a>
### Create user
```
POST /users
```


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|
|**Body**|**user**  <br>*required*|New user data.|[UserNew](#usernew)|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**201**|The user was successfully created.  <br>**Headers** :   <br>`Location` (string) : URI for the newly created 'User' resource.|No Content|
|**400**|The request body is malformed.|[Error](#error)|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**422**|The email address is duplicated or password is too short.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP request

##### Request body
```json
{
  "email" : "user@acme.com",
  "password" : "mypass1234"
}
```


#### Example HTTP response

##### Response 400
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 422
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="users-get"></a>
### List users
```
GET /users
```


#### Description
Returns a non-paged collection of users information.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**200**|Successful response.|< [User](#user) > array|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP response

##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="users-id-get"></a>
### Get user information
```
GET /users/{id}
```


#### Description
Returns user information.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|
|**Path**|**id**  <br>*required*|User id.|string|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**200**|Successful response - a user information is returned.|[User](#user)|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**404**|The user was not found.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP response

##### Response 200
```json
{
  "email" : "user@acme.com",
  "id" : "806603def19d417d004a4b67e",
  "created_ts" : "2016-10-03T16:58:51.639Z",
  "updated_ts" : "2016-10-04T11:33:66.611Z"
}
```


##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 404
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="users-id-put"></a>
### Update user information
```
PUT /users/{id}
```


#### Description
Update user email or change user password.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|
|**Path**|**id**  <br>*required*|User id.|string|
|**Body**|**user_update**  <br>*required*|Updated user data.|[UserUpdate](#userupdate)|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**204**|User information updated.|No Content|
|**400**|The request body is malformed.|[Error](#error)|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**404**|The user does not exist.|[Error](#error)|
|**422**|The email address is duplicated or password is too short.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP request

##### Request body
```json
{
  "email" : "new_email@acme.com",
  "roles" : [ "RBAC_ROLE_DEPLOY_GROUP_TESTING_DEVICES", "RBAC_ROLE_READ_ONLY" ]
}
```


#### Example HTTP response

##### Response 400
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 404
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 422
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```
___

<a name="users-id-delete"></a>
### Remove user from the system
```
DELETE /users/{id}
```


#### Description
Remove user information from the system.


#### Parameters

|Type|Name|Description|Schema|
|---|---|---|---|
|**Header**|**Authorization**  <br>*required*|Contains the JWT token issued by the User Administration and Authentication Service.|string (Bearer [token])|
|**Path**|**id**  <br>*required*|User id.|string|


#### Responses

|HTTP Code|Description|Schema|
|---|---|---|
|**204**|User removed.|No Content|
|**401**|The user cannot be granted authentication.|[Error](#error)|
|**500**|Internal server error.|[Error](#error)|


#### Example HTTP response

##### Response 401
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```


##### Response 500
```json
{
  "error" : "missing Authorization header",
  "request_id" : "f7881e82-0492-49fb-b459-795654e7188a"
}
```




<a name="definitions"></a>
## Definitions

<a name="error"></a>
### Error
Error descriptor.


|Name|Description|Schema|
|---|---|---|
|**error**  <br>*optional*|Description of the error.|string|
|**request_id**  <br>*optional*|Request ID (same as in X-MEN-RequestID header).|string|


<a name="role"></a>
### Role
Role descriptor.


|Name|Description|Schema|
|---|---|---|
|**description**  <br>*optional*|Description of the role, as shown in the UI.|string|
|**name**  <br>*required*|A unique name.|string|
|**permissions**  <br>*optional*| |< [RolePermission](#rolepermission) > array|


<a name="rolepermission"></a>
### RolePermission
Role permission


|Name|Description|Schema|
|---|---|---|
|**action**  <br>*required*|Action|enum (any, http, CREATE_DEPLOYMENT)|
|**object**  <br>*required*| |[RolePermissionObject](#rolepermissionobject)|


<a name="rolepermissionobject"></a>
### RolePermissionObject
Role permission object


|Name|Description|Schema|
|---|---|---|
|**type**  <br>*required*|Type|string|
|**value**  <br>*required*|Value|string|


<a name="settings"></a>
### Settings
User settings.

*Type* : object


<a name="twofactor"></a>
### Twofactor
Two factor authentication token


|Name|Description|Schema|
|---|---|---|
|**token2fa**  <br>*required*|Two factor authentication token|string|


<a name="user"></a>
### User
User descriptor.


|Name|Description|Schema|
|---|---|---|
|**created_ts**  <br>*optional*|Server-side timestamp of the user creation.|string (date-time)|
|**email**  <br>*required*|A unique email address.|string|
|**id**  <br>*required*|User Id.|string|
|**updated_ts**  <br>*optional*|Server-side timestamp of the last user information update.|string (date-time)|


<a name="usernew"></a>
### UserNew
New user descriptor.


|Name|Description|Schema|
|---|---|---|
|**email**  <br>*required*|A unique email address. Invalid characters are non-ascii and '+'.|string|
|**password**  <br>*required*|Password.|string|


<a name="userupdate"></a>
### UserUpdate
Update user information.


|Name|Description|Schema|
|---|---|---|
|**email**  <br>*optional*|A unique email address.|string|
|**password**  <br>*optional*|Password.|string|
|**roles**  <br>*optional*|List of roles for the user. If not provided existing roles are kept.|< string > array|





